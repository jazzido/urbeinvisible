<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Las Ciudades Invisibles</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link href='http://fonts.googleapis.com/css?family=Allura' rel='stylesheet' type='text/css'>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js" type="text/javascript"></script>
        <style type="text/css">
         body {
           background-color: #ddd;
           margin: 0;
           font-family: Georgia, serif;
         }
         h1 {
           font-family: 'Allura', cursive;
           font-size: 80px;
           margin: 0 auto;
           width: 100%;
           height: 85px;
           text-align: center;
           position: fixed; top: 0;
           background-color: #ddd;
           z-index: 1000;
           -webkit-box-shadow: 0px 11px 5px -2px rgba(221,221,221,0.8);
           -moz-box-shadow: 0px 11px 5px -2px rgba(221,221,221,0.8);
           box-shadow: 0px 11px 5px -2px rgba(221,221,221,0.8);
         }
         div#container {
           width: 70%;
           margin: 0 auto;
           margin-top: 100px; margin-bottom: 20px;
           padding: 10px;
         }
         .city {
           background-color: white;
           position: relative;
           padding-left: 8px; padding-right: 8px;
           margin: 0;
           border: 5px solid white;
         }
         .city h3 {
           position: absolute;
           top: -34px;
           left: -220px;
           width: 200px;
           text-align: right;
           // font-family: 'Allura', cursive;
           font-size: 30px;

           -webkit-transform: rotate(-90deg);
           left: -125px;
           top: 74px;
         }
         .city span:hover {
           background-color: #FFFFC0;
           cursor: pointer;
         }
         span.highlight {
           background-color: #FFFFC0;
         }
         .dimmed {
           opacity: 0.2;
         }

        </style>
    </head>
    <body>
        <h1>Las Ciudades Invisibles</h1>
        <div id="container">
            <% sections.keys.each_with_index do |header, i| %>
                <div class="city">
                    <h2 id="h_<%= i %>"><%= header %></h2>
                    <h3><%= sections[header]['city'] %></h3>
                    <p>
                        <% sections[header]['sentences'].each_with_index do |sentence, j| %>
                            <span id="s_<%= i %>_<%= j %>"><%= sentence %></span>
                        <% end %>
                    </p>
                </div>
            <% end %>
        </div>

        <script type="text/javascript">
         $(function() {

             var resetAll = function() {
                 $('div.city').animate({ opacity: 1 })
                 $("body").css("overflow", "auto");
             };

             $(document).keyup(function(e) {
                 if (e.keyCode == 27) { resetAll(); } // ESC
             });


             if (window.location.hash == '') return;
             var sentence = $('span' + window.location.hash);

             var city = sentence.closest('div.city');

             $('html, body').animate({
                 scrollTop: city.offset().top + (city.height() / 2) - ($(window).height() / 2)
             },
                                     1000,
                                     function() {
                                         $('div.city').not(city).animate({ opacity: 0 })
                                         sentence.animate({ backgroundColor: '#FFFFC0' });
                                         $("body").css("overflow", "hidden"); // disable scrolling
                                     }
                                    );

         });
        </script>

        <script type="text/javascript">
         var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
         (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
                        g.src='//www.google-analytics.com/ga.js';
                        s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
